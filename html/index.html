<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>üè¥‚Äç‚ò†Ô∏è PIrateRF üè¥‚Äç‚ò†Ô∏è</title>

    <!-- Favicon for browsers -->
    <link
      rel="icon"
      type="image/png"
      sizes="32x32"
      href="/static/images/favicon-32x32.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="16x16"
      href="/static/images/favicon-16x16.png"
    />

    <!-- Apple touch icon for iOS home screen -->
    <link
      rel="apple-touch-icon"
      sizes="180x180"
      href="/static/images/apple-touch-icon.png"
    />

    <!-- Android Chrome icons -->
    <link
      rel="icon"
      type="image/png"
      sizes="192x192"
      href="/static/images/android-chrome-192x192.png"
    />
    <link
      rel="icon"
      type="image/png"
      sizes="270x270"
      href="/static/images/android-chrome-270x270.png"
    />

    <!-- Web app manifest for mobile -->
    <link rel="manifest" href="/static/site.webmanifest" />
    <meta name="theme-color" content="#000000" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black" />
    <meta name="apple-mobile-web-app-title" content="PIrateRF" />

    <link rel="stylesheet" href="/static/style.css" />
  </head>
  <body>
    <!-- Loading screen overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display: none">
      <div class="loading-content">
        <div class="loading-spinner">üè¥‚Äç‚ò†Ô∏è</div>
        <div class="loading-text">Loading...</div>
      </div>
    </div>

    <!-- Error notification popup -->
    <div
      class="error-notification"
      id="errorNotification"
      style="display: none"
    >
      <div class="error-content">
        <span class="error-message" id="errorMessage"></span>
        <button class="error-close" id="errorClose">‚úï</button>
      </div>
    </div>

    <div class="container">
      <div class="header">
        <div class="title-container">
          <div class="title disconnected" id="title">üè¥‚Äç‚ò†Ô∏è PIrateRF üè¥‚Äç‚ò†Ô∏è</div>
        </div>
      </div>

      <!-- Status Bar -->
      <div class="status-bar" id="statusBar">
        <span id="statusText">Idle</span>
      </div>

      <!-- Control Panel -->
      <div class="control-panel" id="controlPanel">
        <div class="form-group">
          <label for="moduleSelect" class="required">Module</label>
          <select id="moduleSelect">
            <option value="pifmrds" selected>FM Station</option>
            <option value="morse">Morse Code</option>
            <option value="tune">Carrier Wave</option>
            <option value="pichirp">Frequency Sweep</option>
            <option value="spectrumpaint">Spectrum Paint</option>
            <option value="pocsag">POCSAG</option>
            <option value="pift8">FT8</option>
            <option value="pisstv">SSTV</option>
            <option value="pirtty">RTTY</option>
            <option value="fsk">FSK</option>
            <option value="audiosock-broadcast">Live Microphone Broadcast</option>
          </select>
        </div>

        <!-- PIFMRDS Module Form -->
        <div id="pifmrdsForm" class="module-form">
          <div class="form-group">
            <label for="freq" class="required">Frequency</label>
            <input
              type="number"
              id="freq"
              step="0.1"
              placeholder="87.9"
              value="87.9"
              data-module-name="pifmrds"
              data-field-name="freq"
            />
          </div>

          <div class="form-group audio-form-group">
            <label for="audio" class="required">Audio File</label>
            <div class="audio-controls">
              <select
                id="audio"
                data-module-name="pifmrds"
                data-field-name="audio"
              >
                <option value="">Select audio file...</option>
              </select>
              <button
                type="button"
                class="play-btn"
                id="playAudioBtn"
                disabled
                title="Play selected audio"
              >
                ‚ñ∂Ô∏è
              </button>
              <button
                type="button"
                class="refresh-btn"
                id="refreshAudioBtn"
                title="Refresh audio files"
              >
                üîÑ
              </button>
            </div>

            <!-- All other audio control buttons -->
            <div class="audio-method-selector">
              <input type="file" id="audioFile" style="display: none" />
              <button
                type="button"
                class="play-mode-toggle toggle-btn"
                id="playModeToggle"
                title="Loop"
              >
                üîÅ
              </button>
              <button
                type="button"
                class="file-upload-btn"
                id="fileSelectBtn"
                title="Upload audio file"
              >
                üìÅ
              </button>
              <button
                type="button"
                class="record-btn"
                id="recordBtn"
                title="Record audio"
              >
                üé§
              </button>
              <button
                class="playlist-btn"
                id="playlistBtn"
                title="Create playlist"
              >
                üéº
              </button>
              <button
                type="button"
                class="edit-btn"
                id="editAudioBtn"
                disabled
                title="Edit selected audio file"
              >
                ‚úèÔ∏è
              </button>
              <button
                type="button"
                class="intro-outro-toggle toggle-btn"
                id="introOutroToggle"
                title="Toggle intro/outro"
              >
                üé¨
              </button>
            </div>

            <!-- Intro/Outro controls (hidden initially) -->
            <div class="intro-outro-controls hidden" id="introOutroControls">
              <div class="intro-outro-columns">
                <div class="intro-column">
                  <label for="introSelect">Intro</label>
                  <div class="select-with-play">
                    <select
                      id="introSelect"
                      data-module-name="pifmrds"
                      data-field-name="introSelect"
                    >
                      <option value="">No intro</option>
                    </select>
                    <button
                      type="button"
                      class="play-intro-btn"
                      id="playIntroBtn"
                      disabled
                      title="Play intro"
                    >
                      ‚ñ∂Ô∏è
                    </button>
                  </div>
                </div>
                <div class="outro-column">
                  <label for="outroSelect">Outro</label>
                  <div class="select-with-play">
                    <select
                      id="outroSelect"
                      data-module-name="pifmrds"
                      data-field-name="outroSelect"
                    >
                      <option value="">No outro</option>
                    </select>
                    <button
                      type="button"
                      class="play-outro-btn"
                      id="playOutroBtn"
                      disabled
                      title="Play outro"
                    >
                      ‚ñ∂Ô∏è
                    </button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Status displays -->
            <div class="upload-status" id="uploadStatus"></div>
            <div class="record-status" id="recordStatus"></div>
          </div>

          <div class="form-group">
            <label for="pi">PI Code (4 hex digits)</label>
            <div class="input-with-button">
              <input
                type="text"
                id="pi"
                placeholder="FFFF"
                maxlength="4"
                data-module-name="pifmrds"
                data-field-name="pi"
              />
              <button type="button" class="random-btn" id="randomPi">üé≤</button>
            </div>
          </div>

          <div class="form-group">
            <label for="ps">Station Name (max 8 chars)</label>
            <div class="input-with-button">
              <input
                type="text"
                id="ps"
                placeholder="RASP-PI"
                maxlength="8"
                data-module-name="pifmrds"
                data-field-name="ps"
              />
              <button type="button" class="random-btn" id="randomPs">üé≤</button>
            </div>
          </div>

          <div class="form-group">
            <label for="rt">Radio Text (max 64 chars)</label>
            <div class="input-with-button">
              <input
                type="text"
                id="rt"
                placeholder="Hello from PIrateRF!"
                maxlength="64"
                data-module-name="pifmrds"
                data-field-name="rt"
              />
              <button type="button" class="random-btn" id="randomRt">üé≤</button>
            </div>
          </div>

          <div class="form-group">
            <label for="ppm">PPM Clock Correction</label>
            <input
              type="number"
              id="ppm"
              step="0.1"
              placeholder="0"
              data-module-name="pifmrds"
              data-field-name="ppm"
            />
          </div>

          <div class="form-group">
            <label for="timeout">Timeout (seconds, 0 = no timeout)</label>
            <input
              type="number"
              id="timeout"
              placeholder="30"
              min="0"
              value="0"
              data-module-name="pifmrds"
              data-field-name="timeout"
            />
          </div>
        </div>

        <!-- MORSE Module Form -->
        <div id="morseForm" class="module-form hidden">
          <div class="form-group">
            <label for="morseFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="morseFreq"
              step="1"
              placeholder="7058000"
              value="7058000"
              data-module-name="morse"
              data-field-name="freq"
            />
          </div>

          <div class="form-group">
            <label for="morseRate" class="required"
              >Rate (dits per minute)</label
            >
            <input
              type="number"
              id="morseRate"
              min="1"
              placeholder="20"
              value="20"
              data-module-name="morse"
              data-field-name="rate"
            />
          </div>

          <div class="form-group">
            <label for="morseMessage" class="required">Message</label>
            <textarea
              id="morseMessage"
              placeholder="HACK THE PLANET"
              rows="3"
              data-module-name="morse"
              data-field-name="message"
            >
HACK THE PLANET</textarea
            >
          </div>
        </div>

        <!-- TUNE Module Form -->
        <div id="tuneForm" class="module-form hidden">
          <div class="form-group">
            <label for="tuneFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="tuneFreq"
              step="1"
              placeholder="144500000"
              value="144500000"
              data-module-name="tune"
              data-field-name="freq"
            />
          </div>

          <div class="form-group">
            <label for="tuneExitImmediate">Exit Immediate</label>
            <input
              type="checkbox"
              id="tuneExitImmediate"
              data-module-name="tune"
              data-field-name="exitImmediate"
            />
            <span class="checkbox-label"
              >Exit immediately without killing carrier</span
            >
          </div>

          <div class="form-group">
            <label for="tunePPM">PPM Clock Correction</label>
            <input
              type="number"
              id="tunePPM"
              step="0.1"
              placeholder="0"
              data-module-name="tune"
              data-field-name="ppm"
            />
          </div>
        </div>

        <!-- SPECTRUMPAINT Module Form -->
        <div id="spectrumpaintForm" class="module-form hidden">
          <div class="form-group">
            <label for="spectrumpaintFreq" class="required"
              >Frequency (Hz)</label
            >
            <input
              type="number"
              id="spectrumpaintFreq"
              step="1"
              placeholder="144500000"
              value="144500000"
              data-module-name="spectrumpaint"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group image-form-group">
            <label for="pictureFile" class="required">Picture File</label>
            <div class="image-controls">
              <select
                id="pictureFile"
                data-module-name="spectrumpaint"
                data-field-name="pictureFile"
              >
                <option value="">Select image file...</option>
              </select>
              <button
                type="button"
                class="refresh-btn"
                id="refreshImageBtn"
                title="Refresh image files"
              >
                üîÑ
              </button>
            </div>

            <!-- Image control buttons -->
            <div class="image-method-selector">
              <input
                type="file"
                id="imageFile"
                style="display: none"
                accept="image/*"
              />
              <button
                type="button"
                class="file-upload-btn"
                id="imageSelectBtn"
                title="Upload image file"
              >
                üìÅ
              </button>
              <button
                type="button"
                class="edit-btn"
                id="editImageBtn"
                disabled
                title="Edit selected image file"
              >
                ‚úèÔ∏è
              </button>
            </div>

            <!-- Status displays -->
            <div class="upload-status" id="imageUploadStatus"></div>
          </div>

          <div class="form-group">
            <label for="excursion">Excursion (Hz)</label>
            <input
              type="number"
              id="excursion"
              step="1"
              placeholder="100000"
              data-module-name="spectrumpaint"
              data-field-name="excursion"
            />
          </div>
        </div>

        <!-- PICHIRP Module Form -->
        <div id="pichirpForm" class="module-form hidden">
          <div class="form-group">
            <label for="pichirpFreq" class="required"
              >Center Frequency (Hz)</label
            >
            <input
              type="number"
              id="pichirpFreq"
              step="1"
              placeholder="144500000"
              value="144500000"
              data-module-name="pichirp"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="pichirpBandwidth" class="required"
              >Bandwidth (Hz)</label
            >
            <input
              type="number"
              id="pichirpBandwidth"
              step="1"
              placeholder="1000000"
              value="1000000"
              data-module-name="pichirp"
              data-field-name="bandwidth"
            />
          </div>

          <div class="form-group">
            <label for="pichirpTime" class="required"
              >Sweep Duration (seconds)</label
            >
            <input
              type="number"
              id="pichirpTime"
              step="0.1"
              placeholder="5.0"
              value="5.0"
              data-module-name="pichirp"
              data-field-name="time"
            />
          </div>
        </div>

        <!-- POCSAG Module Form -->
        <div id="pocsagForm" class="module-form hidden">
          <div class="form-group">
            <label for="pocsagFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="pocsagFreq"
              step="1"
              placeholder="152000000"
              value="152000000"
              required
              data-module-name="pocsag"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="pocsagBaudRate">Baud Rate</label>
            <select
              id="pocsagBaudRate"
              data-module-name="pocsag"
              data-field-name="baudRate"
            >
              <option value="">Default (1200)</option>
              <option value="512">512</option>
              <option value="1200" selected>1200</option>
              <option value="2400">2400</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pocsagFunctionBits"
              >Function Bits (0-3)</label
            >
            <select
              id="pocsagFunctionBits"
              data-module-name="pocsag"
              data-field-name="functionBits"
            >
              <option value="">Default (3)</option>
              <option value="0">0</option>
              <option value="1">1</option>
              <option value="2">2</option>
              <option value="3" selected>3</option>
            </select>
          </div>

          <div class="form-group">
            <label for="pocsagRepeatCount">Repeat Count</label>
            <input
              type="number"
              id="pocsagRepeatCount"
              min="1"
              placeholder="4"
              value="4"
              data-module-name="pocsag"
              data-field-name="repeatCount"
            />
          </div>

          <div class="form-group">
            <div class="pocsag-toggles">
              <button
                type="button"
                class="pocsag-toggle toggle-btn"
                id="pocsagNumericMode"
                data-module-name="pocsag"
                data-field-name="numericMode"
                title="Toggle numeric mode"
              >
                üìä Numeric Mode
              </button>
              <button
                type="button"
                class="pocsag-toggle toggle-btn"
                id="pocsagInvertPolarity"
                data-module-name="pocsag"
                data-field-name="invertPolarity"
                title="Toggle polarity inversion"
              >
                üîÑ Invert Polarity
              </button>
              <button
                type="button"
                class="pocsag-toggle toggle-btn"
                id="pocsagDebug"
                data-module-name="pocsag"
                data-field-name="debug"
                title="Toggle debug mode"
              >
                üêõ Debug Mode
              </button>
            </div>
          </div>

          <div class="form-group">
            <label class="required">Messages</label>
            <div class="pocsag-messages" id="pocsagMessages">
              <div class="pocsag-message" data-message-index="0">
                <div class="message-header">
                  <span>#1</span>
                  <button
                    type="button"
                    class="remove-message-btn"
                    title="Remove message"
                  >
                    ‚ùå
                  </button>
                </div>
                <div class="message-fields">
                  <div class="form-group">
                    <label for="pocsagAddress0" class="required">Address</label>
                    <input
                      type="number"
                      id="pocsagAddress0"
                      min="0"
                      placeholder="123456"
                      value="123456"
                      data-message-field="address"
                    />
                  </div>
                  <div class="form-group">
                    <label for="pocsagMessage0" class="required">Message</label>
                    <textarea
                      id="pocsagMessage0"
                      placeholder="TEST MESSAGE"
                      rows="2"
                      data-message-field="message"
                    >
TEST MESSAGE</textarea
                    >
                  </div>
                  <div class="form-group">
                    <label for="pocsagMessageFunctionBits0"
                      >Function Bits</label
                    >
                    <select
                      id="pocsagMessageFunctionBits0"
                      data-message-field="functionBits"
                    >
                      <option value="">Use global setting</option>
                      <option value="0">0</option>
                      <option value="1">1</option>
                      <option value="2">2</option>
                      <option value="3">3</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>
            <div style="display: flex; justify-content: center; margin-top: 10px;">
              <button type="button" class="add-message-btn" id="addMessageBtn">
                ‚ûï
              </button>
            </div>
          </div>
        </div>

        <!-- FT8 Module Form -->
        <div id="pift8Form" class="module-form hidden">
          <div class="form-group">
            <label for="ft8Freq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="ft8Freq"
              step="1"
              placeholder="14074000"
              value="14074000"
              data-module-name="pift8"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="ft8Message" class="required">Message</label>
            <input
              type="text"
              id="ft8Message"
              placeholder="CQ CA0ALL JN06"
              data-module-name="pift8"
              data-field-name="message"
            />
          </div>

          <div class="form-group">
            <label for="ft8PPM">PPM Clock Correction</label>
            <input
              type="number"
              id="ft8PPM"
              step="0.1"
              placeholder="0"
              data-module-name="pift8"
              data-field-name="ppm"
            />
          </div>

          <div class="form-group">
            <label for="ft8Offset">Frequency Offset (0-2500 Hz)</label>
            <input
              type="number"
              id="ft8Offset"
              step="1"
              min="0"
              max="2500"
              placeholder="1240"
              data-module-name="pift8"
              data-field-name="offset"
            />
          </div>

          <div class="form-group">
            <label for="ft8Slot">Time Slot</label>
            <select
              id="ft8Slot"
              data-module-name="pift8"
              data-field-name="slot"
            >
              <option value="0" selected>0 - First 15s slot</option>
              <option value="1">1 - Second 15s slot</option>
              <option value="2">2 - Always (every 15s)</option>
            </select>
          </div>

          <div class="form-group">
            <button
              type="button"
              class="toggle-btn"
              id="ft8Repeat"
              data-module-name="pift8"
              data-field-name="repeat"
              title="Toggle repeat mode (every 15 seconds)"
            >
              üîÅ Repeat Mode
            </button>
          </div>
        </div>

        <!-- PISSTV Module Form -->
        <div id="pisstvForm" class="module-form hidden">
          <div class="form-group">
            <label for="pisstvFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="pisstvFreq"
              step="1"
              placeholder="14233000"
              value="14233000"
              data-module-name="pisstv"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="pisstvPictureFile" class="required">Picture File</label>
            <div class="image-controls">
              <select
                id="pisstvPictureFile"
                data-module-name="pisstv"
                data-field-name="pictureFile"
              >
                <option value="">Select picture file...</option>
              </select>
              <button
                type="button"
                class="refresh-btn"
                id="refreshPisstvImageBtn"
                title="Refresh image list"
              >
                üîÑ
              </button>
            </div>

            <!-- PISSTV control buttons -->
            <div class="image-method-selector">
              <button
                type="button"
                class="file-upload-btn"
                id="pisstvImageSelectBtn"
                title="Upload image file"
              >
                üìÅ
              </button>
              <button
                type="button"
                class="edit-btn"
                id="editPisstvImageBtn"
                disabled
                title="Edit selected image file"
              >
                ‚úèÔ∏è
              </button>
            </div>
          </div>
        </div>

        <!-- PIRTTY Module Form -->
        <div id="pirttyForm" class="module-form hidden">
          <div class="form-group">
            <label for="pirttyFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="pirttyFreq"
              step="1"
              placeholder="14075000"
              value="14075000"
              data-module-name="pirtty"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="pirttySpaceFreq">Space Frequency (Hz)</label>
            <input
              type="number"
              id="pirttySpaceFreq"
              step="1"
              placeholder="170"
              data-module-name="pirtty"
              data-field-name="spaceFrequency"
            />
          </div>

          <div class="form-group">
            <label for="pirttyMessage" class="required">Message</label>
            <input
              type="text"
              id="pirttyMessage"
              placeholder="HACK THE FUCKIN PLANET"
              data-module-name="pirtty"
              data-field-name="message"
            />
          </div>
        </div>

        <!-- FSK Module Form -->
        <div id="fskForm" class="module-form hidden">
          <div class="form-group">
            <label for="fskFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="fskFreq"
              step="1"
              placeholder="144500000"
              value="144500000"
              data-module-name="fsk"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <div class="fsk-toggles">
              <button
                type="button"
                class="fsk-toggle toggle-btn active"
                id="fskInputTypeText"
                data-module-name="fsk"
                data-field-name="inputType"
                data-value="text"
                title="Text input mode"
              >
                üìù Text
              </button>
              <button
                type="button"
                class="fsk-toggle toggle-btn"
                id="fskInputTypeFile"
                data-module-name="fsk"
                data-field-name="inputType"
                data-value="file"
                title="File input mode"
              >
                üìÅ File
              </button>
            </div>
          </div>

          <div class="form-group" id="fskTextGroup">
            <label for="fskText" class="required">Text</label>
            <textarea
              id="fskText"
              rows="4"
              placeholder="HACK THE FUCKIN PLANET"
              data-module-name="fsk"
              data-field-name="text"
            ></textarea>
          </div>

          <div class="form-group hidden" id="fskFileGroup">
            <label for="fskFile" class="required">Data File</label>
            <div class="file-controls">
              <select
                id="fskFile"
                data-module-name="fsk"
                data-field-name="file"
              >
                <option value="">Select data file...</option>
              </select>
              <button
                type="button"
                class="refresh-btn"
                id="refreshFskFileBtn"
                title="Refresh file list"
              >
                üîÑ
              </button>
            </div>

            <!-- FSK file control buttons -->
            <div class="file-method-selector">
              <input
                type="file"
                id="fskDataFile"
                style="display: none"
                accept="*/*"
              />
              <button
                type="button"
                class="file-upload-btn"
                id="fskFileSelectBtn"
                title="Upload data file"
              >
                üìÅ
              </button>
              <button
                type="button"
                class="edit-btn"
                id="editFskFileBtn"
                disabled
                title="Edit selected data file"
              >
                ‚úèÔ∏è
              </button>
            </div>
          </div>

          <div class="form-group">
            <label for="fskBaudRate">Baud Rate</label>
            <input
              type="number"
              id="fskBaudRate"
              step="1"
              placeholder="50"
              data-module-name="fsk"
              data-field-name="baudRate"
            />
          </div>
        </div>

        <!-- USB AudioSock Broadcast Module Form -->
        <div id="audiosock-broadcastForm" class="module-form hidden">
          <div class="form-group">
            <label for="audioSockBroadcastFreq" class="required">Frequency (Hz)</label>
            <input
              type="number"
              id="audioSockBroadcastFreq"
              step="1"
              placeholder="27225000"
              value="27225000"
              data-module-name="audiosock-broadcast"
              data-field-name="frequency"
            />
          </div>

          <div class="form-group">
            <label for="audioSockBroadcastSampleRate">Sample Rate (Hz)</label>
            <input
              type="number"
              id="audioSockBroadcastSampleRate"
              step="1"
              placeholder="48000"
              data-module-name="audiosock-broadcast"
              data-field-name="sampleRate"
            />
          </div>

          <div class="form-group">
            <label for="audioSockBroadcastBufferSize">Browser Audio Buffer Size (samples)</label>
            <select
              id="audioSockBroadcastBufferSize"
              data-module-name="audiosock-broadcast"
              data-field-name="bufferSize"
            >
              <option value="1024">1024 (low latency, may glitch)</option>
              <option value="2048">2048 (balanced)</option>
              <option value="4096" selected>4096 (default)</option>
              <option value="8192">8192 (high quality, higher latency)</option>
              <option value="16384">16384 (max quality, high latency)</option>
            </select>
            <span class="help-text">Larger buffers reduce audio glitches but increase latency. Smaller buffers are more responsive but may cause dropouts.</span>
          </div>

          <div class="form-group">
            <label for="audioSockBroadcastCsdrPreset">CSDR Preset</label>
            <select
              id="audioSockBroadcastCsdrPreset"
              data-module-name="audiosock-broadcast"
              data-field-name="modulation"
            >
              <option value="AM">AM</option>
              <option value="DSB">DSB</option>
              <option value="USB">USB</option>
              <option value="LSB">LSB</option>
              <option value="FM" selected>FM</option>
              <option value="RAW">RAW</option>
            </select>
          </div>

          <div class="form-group">
            <label for="audioSockBroadcastGain">Gain</label>
            <input
              type="number"
              id="audioSockBroadcastGain"
              step="0.1"
              min="0"
              placeholder="1.0"
              data-module-name="audiosock-broadcast"
              data-field-name="gain"
            />
          </div>
        </div>

        <div class="button-group">
          <button class="start-btn" id="startBtn" disabled>üì° Transmit</button>
          <button class="stop-btn hidden" id="stopBtn">üõë Stop</button>
        </div>
      </div>

      <!-- System Output -->
      <div class="system-output" id="systemOutput">
        <div class="output-content" id="outputContent"></div>
      </div>
    </div>

    <!-- File Edit Modal (Unified for all file types) -->
    <div class="modal-overlay" id="fileEditModal" style="display: none">
      <div class="modal">
        <div class="modal-header">
          <h3 id="fileEditModalTitle">Edit File</h3>
          <button type="button" class="modal-close" id="modalCloseBtn">
            ‚úï
          </button>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <label for="editFileName">File Name</label>
            <input type="text" id="editFileName" placeholder="filename" />
          </div>
        </div>
        <div class="modal-footer">
          <button type="button" class="cancel-btn" id="modalCancelBtn">
            ‚ùå
          </button>
          <button type="button" class="delete-btn" id="deleteFileBtn">
            üóëÔ∏è
          </button>
          <button type="button" class="save-btn" id="renameFileBtn">üíæ</button>
        </div>
      </div>
    </div>

    <!-- Playlist Modal -->
    <div class="modal-overlay" id="playlistModal" style="display: none">
      <div class="modal playlist-modal">
        <div class="modal-header">
          <h3>Create Audio Playlist</h3>
          <button type="button" class="modal-close" id="playlistModalCloseBtn">
            ‚úï
          </button>
        </div>
        <div class="modal-body">
          <div class="playlist-container">
            <!-- Available files section -->
            <div class="available-files">
              <!-- Playlist name input -->
              <div class="playlist-name-section">
                <label for="playlistName">Playlist Name:</label>
                <input
                  type="text"
                  id="playlistName"
                  placeholder="playlist_name.wav"
                />
              </div>

              <h4>Available Files</h4>
              <div class="file-categories">
                <div class="file-category">
                  <h5>SFX Files</h5>
                  <div class="file-list" id="sfxFileList"></div>
                </div>
                <div class="file-category">
                  <h5>Uploaded Audio</h5>
                  <div class="file-list" id="uploadedFileList"></div>
                </div>
              </div>
            </div>

            <!-- Playlist section -->
            <div class="playlist-section">
              <h4>Playlist</h4>
              <div class="playlist-items" id="playlistItems">
                <div class="empty-playlist">
                  Click "Add" next to files to build your playlist
                </div>
              </div>
              <div
                class="playlist-error"
                id="playlistError"
                style="display: none"
              ></div>
              <div class="playlist-controls">
                <button type="button" class="clear-btn" id="clearPlaylistBtn">
                  üóëÔ∏è Clear
                </button>
                <button type="button" class="create-btn" id="createPlaylistBtn">
                  üéµ Create
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Hidden audio element for playback -->
    <audio id="audioPlayer" preload="none"></audio>

    <script src="/static/env.js"></script>
    <script src="/static/script.js"></script>
  </body>
</html>
